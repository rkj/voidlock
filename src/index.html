<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <link rel="icon" type="image/svg+xml" href="/vite.svg" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Voidlock</title>
    <link rel="stylesheet" href="/styles/main.css" />
  </head>
  <body>
    <div id="app">
      <!-- 1. Main Menu -->
      <div id="screen-main-menu" class="screen screen-centered">
        <h1>Voidlock</h1>
        <p id="menu-version"></p>

        <div style="margin-top: 40px">
          <button id="btn-menu-campaign" class="menu-button">Campaign</button
          ><br />
          <button id="btn-menu-custom" class="menu-button">
            Custom Mission</button
          ><br />
          <button id="btn-menu-statistics" class="menu-button">Statistics</button
          ><br />
          <button
            id="btn-menu-reset"
            class="menu-button back-button"
            style="font-size: 0.8em; width: 200px; margin-top: 40px"
          >
            Reset Data
          </button>
          <div
            style="
              margin-top: 20px;
              border-top: 1px solid var(--color-border);
              padding-top: 20px;
            "
          >
            <label
              for="import-replay"
              style="
                cursor: pointer;
                display: inline-block;
                border: 1px solid var(--color-text-dim);
                padding: 5px 10px;
              "
              >Load Replay JSON</label
            >
            <input
              type="file"
              id="import-replay"
              accept=".json"
              style="display: none"
            />
          </div>
        </div>
      </div>

      <!-- 2. Campaign Shell wrapper -->
      <div id="screen-campaign-shell" class="screen flex-col">
          <div id="campaign-shell-top-bar"></div>
          <div id="campaign-shell-content" class="flex-grow relative overflow-hidden">
              <!-- 2a. Campaign Screen -->
              <div id="screen-campaign" class="screen screen-centered">
                <h1>Campaign</h1>
                <p>Mission list unavailable in prototype.</p>
                <button id="btn-campaign-back" class="back-button">Back to Menu</button>
              </div>

              <!-- 2b. Equipment Screen -->
              <div id="screen-equipment" class="screen">
                <!-- Content will be injected by EquipmentScreen.ts -->
              </div>

              <!-- 2c. Barracks Screen -->
              <div id="screen-barracks" class="screen">
                <!-- Content will be injected by BarracksScreen.ts -->
              </div>

              <!-- 2d. Statistics Screen -->
              <div id="screen-statistics" class="screen">
                <!-- Content will be injected by StatisticsScreen.ts -->
              </div>
          </div>
      </div>

      <!-- 3. Mission Setup Screen -->
      <div id="screen-mission-setup" class="screen screen-centered">
        <h1>Mission Configuration</h1>
        <div id="mission-setup-context" style="margin-bottom: 20px; color: var(--color-primary); font-weight: bold; letter-spacing: 1px;"></div>
        <div id="setup-content">
          <div id="map-config-section" style="width: 100%">
            <div class="control-group">
              <label for="map-generator-type">Generator Type:</label>
              <select id="map-generator-type">
                <option value="Procedural">Procedural</option>
                <option value="Static">Static Map</option>
              </select>
            </div>

            <div class="control-group">
              <div id="preset-map-controls">
                <label for="map-seed">Map Seed:</label>
                <input type="number" id="map-seed" placeholder="Random" />

                <div style="display: flex; gap: 10px">
                  <div style="flex: 1">
                    <label for="map-width">Width:</label>
                    <input type="number" id="map-width" value="14" />
                  </div>
                  <div style="flex: 1">
                    <label for="map-height">Height:</label>
                    <input type="number" id="map-height" value="14" />
                  </div>
                </div>

                <label for="map-spawn-points">Enemy Spawns: <span id="map-spawn-points-value">1</span></label>
                <input
                  type="range"
                  id="map-spawn-points"
                  value="1"
                  min="1"
                  max="10"
                  step="1"
                />

                <label for="map-starting-threat"
                  >Starting Threat:
                  <span id="map-starting-threat-value">0</span>%</label
                >
                <input
                  type="range"
                  id="map-starting-threat"
                  min="0"
                  max="100"
                  step="5"
                  value="0"
                />

                <label for="map-base-enemies">Base Wave Size: <span id="map-base-enemies-value">3</span></label>
                <input
                  type="range"
                  id="map-base-enemies"
                  value="3"
                  min="1"
                  max="20"
                  step="1"
                />

                <label for="map-enemy-growth">Wave Growth: <span id="map-enemy-growth-value">1.0</span></label>
                <input
                  type="range"
                  id="map-enemy-growth"
                  value="1.0"
                  min="0.1"
                  max="5.0"
                  step="0.1"
                />
              </div>

              <div id="static-map-controls" style="display: none">
                <h3>Static Map</h3>
                <textarea
                  id="static-map-json"
                  rows="5"
                  placeholder="Paste JSON MapDefinition here..."
                ></textarea>
                <button id="load-static-map">Load JSON</button>
                <input type="file" id="upload-static-map" accept=".json" />

                <h3 style="margin-top: 15px">ASCII Map</h3>
                <textarea
                  id="ascii-map-input"
                  rows="5"
                  placeholder="Paste ASCII map here..."
                ></textarea>
                <button id="convert-ascii-to-map">Convert ASCII</button>
              </div>
            </div>
          </div>

          <div class="control-group">
            <h3>Squad Selection</h3>
            <div id="squad-builder">
              <!-- Injected by JS -->
            </div>
          </div>

          <div
            style="
              margin-top: 30px;
              width: 100%;
              display: flex;
              justify-content: space-between;
            "
          >
            <button id="btn-setup-back" class="back-button">Back</button>
            <button
              id="btn-goto-equipment"
              style="font-size: 1.2em; padding: 15px 30px"
            >
              Equipment & Supplies
            </button>
          </div>
        </div>
      </div>

      <!-- 4. Mission Screen (Game Loop) -->
      <div id="screen-mission" class="screen">
        <!-- 1. Top Bar -->
        <div id="top-bar" class="top-bar">
          <div
            id="game-status"
            style="font-weight: bold; color: var(--color-primary)"
          >
            Time: 0.0s
          </div>
          <div
            id="top-threat-container"
            style="
              display: flex;
              align-items: center;
              gap: 10px;
              flex-grow: 1;
              justify-content: center;
              max-width: 450px;
              margin: 0 20px;
            "
          >
            <span
              style="
                font-size: 0.8em;
                color: var(--color-text-muted);
                white-space: nowrap;
              "
              >Threat:</span
            >
            <div id="top-threat-bar" class="threat-bar">
              <!-- Robust Flex-based Dividers every 10% -->
              <div
                style="
                  position: absolute;
                  inset: 0;
                  display: flex;
                  pointer-events: none;
                  z-index: 1;
                "
              >
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="
                    width: 10%;
                    height: 100%;
                    border-right: 1px solid #666;
                    box-sizing: border-box;
                  "
                ></div>
                <div
                  style="width: 10%; height: 100%; box-sizing: border-box"
                ></div>
              </div>
              <div id="top-threat-fill" class="threat-fill"></div>
            </div>
            <span
              id="top-threat-value"
              style="
                font-size: 0.8em;
                color: var(--color-success);
                min-width: 40px;
              "
              >0%</span
            >
          </div>

          <!-- Speed Control -->
          <div
            id="speed-control"
            style="
              display: flex;
              align-items: center;
              gap: 5px;
              margin-left: 20px;
            "
          >
            <button
              id="btn-pause-toggle"
              style="
                margin: 0;
                padding: 2px 10px;
                min-width: 60px;
                font-size: 0.8em;
              "
            >
              ‚è∏ Pause
            </button>
            <label
              for="game-speed"
              style="
                font-size: 0.8em;
                color: var(--color-text-muted);
                margin: 0;
              "
              >Speed:</label
            >
            <input
              type="range"
              id="game-speed"
              min="0"
              max="100"
              step="1"
              value="50"
              style="width: 80px"
              title="Game Speed (0.1x to 10.0x)"
            />
            <span
              id="speed-value"
              style="
                font-size: 0.8em;
                color: var(--color-text-muted);
                min-width: 30px;
              "
              >1.0x</span
            >
          </div>

          <button
            id="btn-give-up"
            style="
              margin-left: 10px;
              padding: 2px 10px;
              font-size: 0.8em;
              background-color: #442222;
              border-color: #ff4444;
              color: #ffcccc;
              white-space: nowrap;
            "
          >
            Give Up
          </button>
        </div>

        <!-- 2. Soldier Bar (RPG Style) -->
        <div id="soldier-panel" class="soldier-panel">
          <div id="soldier-list">
            <!-- Soldier cards injected here -->
          </div>
        </div>

        <!-- 3. Main Area -->
        <div
          id="mission-body"
          style="
            display: flex;
            flex-grow: 1;
            overflow: hidden;
            background: #000;
          "
        >
          <div
            id="game-container"
            style="
              flex-grow: 1;
              display: flex;
              justify-content: center;
              align-items: center;
              position: relative;
              overflow: auto;
            "
          >
            <canvas id="game-canvas"></canvas>
          </div>

          <div id="right-panel" class="right-panel">
            <!-- Commands and Objectives will be injected here -->
          </div>
        </div>
      </div>

      <!-- 5. Debrief Screen -->
      <div
        id="screen-debrief"
        class="screen"
        style="
          z-index: 1000;
          background: rgba(0, 0, 0, 0.8);
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        "
      >
        <!-- Content will be injected by DebriefScreen.ts -->
      </div>

      <!-- 6. Campaign Summary Screen -->
      <div
        id="screen-campaign-summary"
        class="screen"
        style="
          z-index: 1100;
          background: rgba(0, 0, 0, 0.9);
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
        "
      >
        <!-- Content will be injected by CampaignSummaryScreen.ts -->
      </div>
    <div id="modal-container"></div>
    <script type="module" src="/renderer/main.ts"></script>
  </body>
</html>